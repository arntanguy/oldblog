<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="utf-8"> 
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Arnaud TANGUY" />
        <meta name="copyright" content="Arnaud TANGUY" />

        <meta name="twitter:creator" content="@arntanguy">
        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="linux, ubuntu, nvidia, prime, Linux, " />

<meta property="og:title" content="Dealing with Optimus and PRIME issues (tearing, screen refresh...) "/>
<meta property="og:url" content="http://arntanguy.github.io/blog/dealing-with-optimus-and-prime-issues-tearing-screen-refresh.html" />
<meta property="og:description" content="Plenty of issues arise when trying to use Optimus-enabled laptops with NVIDIA-Prime." />
<meta property="og:site_name" content="VIM Proves The World" />
<meta property="og:article:author" content="Arnaud TANGUY" />
<meta property="og:article:published_time" content="2016-06-20T00:00:00+02:00" />
<meta name="twitter:title" content="Dealing with Optimus and PRIME issues (tearing, screen refresh...) ">
<meta name="twitter:description" content="Plenty of issues arise when trying to use Optimus-enabled laptops with NVIDIA-Prime.">

        <title>Dealing with Optimus and PRIME issues (tearing, screen refresh...)  · VIM Proves The World
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="http://arntanguy.github.io/blog/theme/css/pygments.css" media="screen">
        <link rel="stylesheet" type="text/css" href="http://arntanguy.github.io/blog/theme/tipuesearch/tipuesearch.css" media="screen">
        <link rel="stylesheet" type="text/css" href="http://arntanguy.github.io/blog/theme/css/elegant.css" media="screen">
        <link rel="stylesheet" type="text/css" href="http://arntanguy.github.io/blog/theme/css/custom.css" media="screen">
        <link href="http://arntanguy.github.io/blog/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="VIM Proves The World - Full Atom Feed" />
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
     m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
     })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-46439484-1', 'auto');
    ga('send', 'pageview');
</script>
    </head>
    <body>
        <div id="content-sans-footer">
        <div class="navbar navbar-static-top">
            <div class="navbar-inner">
                <div class="container-fluid">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="http://arntanguy.github.io/blog/"><span class=site-name>VIM Proves The World</span></a>
                    <div class="nav-collapse collapse">
                        <ul class="nav pull-right top-menu">
                            <li ><a href="http://arntanguy.github.io/blog">Home</a></li>
                            <li ><a href="http://arntanguy.github.io/blog/pages/links.html">Links</a></li>
                            <li ><a href="http://arntanguy.github.io/blog/categories.html">Categories</a></li>
                            <li ><a href="http://arntanguy.github.io/blog/tags.html">Tags</a></li>
                            <li ><a href="http://arntanguy.github.io/blog/archives.html">Archives</a></li>
                            <li><form class="navbar-search" action="http://arntanguy.github.io/blog/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span1"></div>
                <div class="span10">
<article>
<div class="row-fluid">
    <header class="page-header span10 offset2">
    <h1><a href="http://arntanguy.github.io/blog/dealing-with-optimus-and-prime-issues-tearing-screen-refresh.html"> Dealing with Optimus and PRIME issues (tearing, screen refresh...)  </a></h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">

            
            <p>This is a summary of my solutions to my own issues.
disqus_identifier: geenux-nvidia-prime</p>
<p>My work has me dealing with GPU computing and OpenGL rendering on a regular basis, and most program I use daily 
require intensive GPU usage. Unfortunately for me, my laptop is blessed with an Optimus setup, of the worst kind, it is entirely muxless.
That means that all display ports (VGA, HDMI, and internal screen) are physically wired to the Intel integrated chipset.
My NVIDIA GTX 660M itself isn't wired directly to the outputs. This means that anything computed by the NVIDIA card will have to be 
shared with the Intel chipset for on-screen rendering. There are two common ways for doing so:</p>
<ul>
<li>
<p><em>bumblebee</em>: In that case, applications are manually lanched on the NVIDIA GPU using primusrun, 
and the specific application buffer is then copied to the intel GPU.</p>
</li>
<li>
<p>NVIDIA prime is a more recent attempt at solving the issue. With prime in use, everything is rendered on the NVIDIA GPU.</p>
</li>
</ul>
<p>The first solution is meant to save battery power, using the NVIDIA GPU "on-demand" when manually requested. This is not a practical solution
for my use case, and as such, I'm stuck with NVIDIA prime solution.</p>
<p>Here is a summary of the issues I encountered</p>
<ul>
<li>Everything is fine using the internal laptop screen only</li>
<li>Using external screen, whether over VGA and HDMI output causes extreme tearin. Additionaly, usually either one of the screens
would not be globally refreshed, leading to refresh issues with multiple trailing pointers, or in extreme cases only parts of the screen
where the mouse had moved would be refreshed!</li>
</ul>
<p>Sadly I could not find any solution for the tearing.
According to <a href="https://devtalk.nvidia.com/default/topic/775691/linux/vsync-issue-nvidia-prime-ux32vd-with-gt620-m-/1">this NVIDIA devtalk</a> thread, it seems that 
there is no synchronisation between NVIDIA and Intel as of yet, though work is under way and merely waiting to be merged. There is hope yet, keep on following this 
thread to see where it goes.</p>
<p>I did find a solution for the multi-screen refresh issues. This <a href="https://www.reddit.com/r/archlinux/comments/4cojj9/it_is_probably_time_to_ditch_xf86videointel">Archlinux Reddit thread</a>
proposed replacing the bloated DDX driver from intel (x86-video-intel), with its opensource counterpart <em>modesetting</em> (xf86-video-modesetting).
This did the trick for me, here are the steps I took to do just that:</p>
<ul>
<li>
<p>Remove the intel driver </p>
<p>::bash
sudo apt-get remove xserver-xorg-video-intel</p>
</li>
<li>
<p>Install modesetting</p>
<p>::bash
sudo apt-get install xserver-xorg-video-modesetting</p>
</li>
</ul>
<p>After reboot, modesetting ought to be in use. If not, you may add it to your xorg.conf (this should not be necessary)</p>
<div class="highlight"><pre><span class="n">Section</span> <span class="s">&quot;ServerLayout&quot;</span>
    <span class="n">Identifier</span> <span class="s">&quot;layout&quot;</span>
    <span class="n">Screen</span> <span class="mi">0</span> <span class="s">&quot;nvidia&quot;</span>
    <span class="n">Inactive</span> <span class="s">&quot;intel&quot;</span>
<span class="n">EndSection</span>

<span class="n">Section</span> <span class="s">&quot;Device&quot;</span>
    <span class="n">Identifier</span> <span class="s">&quot;intel&quot;</span>
    <span class="n">Driver</span> <span class="s">&quot;intel&quot;</span>
    <span class="n">BusID</span> <span class="s">&quot;PCI:0@0:2:0&quot;</span>
    <span class="n">Option</span> <span class="s">&quot;AccelMethod&quot;</span> <span class="s">&quot;SNA&quot;</span>
    <span class="n">Driver</span> <span class="s">&quot;modesetting&quot;</span>
<span class="n">EndSection</span>

<span class="n">Section</span> <span class="s">&quot;Screen&quot;</span>
    <span class="n">Identifier</span> <span class="s">&quot;intel&quot;</span>
    <span class="n">Device</span> <span class="s">&quot;intel&quot;</span>
<span class="n">EndSection</span>

<span class="n">Section</span> <span class="s">&quot;Device&quot;</span>
    <span class="n">Identifier</span> <span class="s">&quot;nvidia&quot;</span>
    <span class="n">Driver</span> <span class="s">&quot;nvidia&quot;</span>
    <span class="n">BusID</span> <span class="s">&quot;PCI:1@0:0:0&quot;</span>
    <span class="n">Option</span> <span class="s">&quot;ConstrainCursor&quot;</span> <span class="s">&quot;off&quot;</span>
<span class="n">EndSection</span>

<span class="n">Section</span> <span class="s">&quot;Screen&quot;</span>
    <span class="n">Identifier</span> <span class="s">&quot;nvidia&quot;</span>
    <span class="n">Device</span> <span class="s">&quot;nvidia&quot;</span>
    <span class="n">Option</span> <span class="s">&quot;AllowEmptyInitialConfiguration&quot;</span> <span class="s">&quot;on&quot;</span>
    <span class="n">Option</span> <span class="s">&quot;IgnoreDisplayDevices&quot;</span> <span class="s">&quot;CRT&quot;</span>
<span class="n">EndSection</span>
</pre></div>


<p>To lessen the tearing issues, I also switched my window manager to compton, with the following configuration:</p>
<div class="highlight"><pre><span class="err">#################################</span>
<span class="err">#</span>
<span class="err">#</span> <span class="nt">Backend</span>
<span class="err">#</span>
<span class="err">#################################</span>

<span class="err">#</span> <span class="nt">Backend</span> <span class="nt">to</span> <span class="nt">use</span><span class="o">:</span> <span class="s2">&quot;xrender&quot;</span> <span class="nt">or</span> <span class="s2">&quot;glx&quot;</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">GLX</span> <span class="nt">backend</span> <span class="nt">is</span> <span class="nt">typically</span> <span class="nt">much</span> <span class="nt">faster</span> <span class="nt">but</span> <span class="nt">depends</span> <span class="nt">on</span> <span class="nt">a</span> <span class="nt">sane</span> <span class="nt">driver</span><span class="o">.</span>
<span class="nt">backend</span> <span class="o">=</span> <span class="s2">&quot;glx&quot;</span><span class="o">;</span>

<span class="err">#################################</span>
<span class="err">#</span>
<span class="err">#</span> <span class="nt">GLX</span> <span class="nt">backend</span>
<span class="err">#</span>
<span class="err">#################################</span>

<span class="nt">glx-no-stencil</span> <span class="o">=</span> <span class="nt">true</span><span class="o">;</span>

<span class="err">#</span> <span class="nt">GLX</span> <span class="nt">backend</span><span class="o">:</span> <span class="nt">Copy</span> <span class="nt">unmodified</span> <span class="nt">regions</span> <span class="nt">from</span> <span class="nt">front</span> <span class="nt">buffer</span> <span class="nt">instead</span> <span class="nt">of</span> <span class="nt">redrawing</span> <span class="nt">them</span> <span class="nt">all</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">My</span> <span class="nt">tests</span> <span class="nt">with</span> <span class="nt">nvidia-drivers</span> <span class="nt">show</span> <span class="nt">a</span> <span class="nt">10</span><span class="o">%</span> <span class="nt">decrease</span> <span class="nt">in</span> <span class="nt">performance</span> <span class="nt">when</span> <span class="nt">the</span> <span class="nt">whole</span> <span class="nt">screen</span> <span class="nt">is</span> <span class="nt">modified</span><span class="o">,</span>
<span class="err">#</span> <span class="nt">but</span> <span class="nt">a</span> <span class="nt">20</span><span class="o">%</span> <span class="nt">increase</span> <span class="nt">when</span> <span class="nt">only</span> <span class="nt">1</span><span class="o">/</span><span class="nt">4</span> <span class="nt">is</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">My</span> <span class="nt">tests</span> <span class="nt">on</span> <span class="nt">nouveau</span> <span class="nt">show</span> <span class="nt">terrible</span> <span class="nt">slowdown</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">Useful</span> <span class="nt">with</span> <span class="nt">--glx-swap-method</span><span class="o">,</span> <span class="nt">as</span> <span class="nt">well</span><span class="o">.</span>
<span class="nt">glx-copy-from-front</span> <span class="o">=</span> <span class="nt">false</span><span class="o">;</span>

<span class="err">#</span> <span class="nt">GLX</span> <span class="nt">backend</span><span class="o">:</span> <span class="nt">Use</span> <span class="nt">MESA_copy_sub_buffer</span> <span class="nt">to</span> <span class="nt">do</span> <span class="nt">partial</span> <span class="nt">screen</span> <span class="nt">update</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">My</span> <span class="nt">tests</span> <span class="nt">on</span> <span class="nt">nouveau</span> <span class="nt">shows</span> <span class="nt">a</span> <span class="nt">200</span><span class="o">%</span> <span class="nt">performance</span> <span class="nt">boost</span> <span class="nt">when</span> <span class="nt">only</span> <span class="nt">1</span><span class="o">/</span><span class="nt">4</span> <span class="nt">of</span> <span class="nt">the</span> <span class="nt">screen</span> <span class="nt">is</span> <span class="nt">updated</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">May</span> <span class="nt">break</span> <span class="nt">VSync</span> <span class="nt">and</span> <span class="nt">is</span> <span class="nt">not</span> <span class="nt">available</span> <span class="nt">on</span> <span class="nt">some</span> <span class="nt">drivers</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">Overrides</span> <span class="nt">--glx-copy-from-front</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">glx-use-copysubbuffermesa</span> <span class="o">=</span> <span class="nt">true</span><span class="o">;</span>

<span class="err">#</span> <span class="nt">GLX</span> <span class="nt">backend</span><span class="o">:</span> <span class="nt">Avoid</span> <span class="nt">rebinding</span> <span class="nt">pixmap</span> <span class="nt">on</span> <span class="nt">window</span> <span class="nt">damage</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">Probably</span> <span class="nt">could</span> <span class="nt">improve</span> <span class="nt">performance</span> <span class="nt">on</span> <span class="nt">rapid</span> <span class="nt">window</span> <span class="nt">content</span> <span class="nt">changes</span><span class="o">,</span> <span class="nt">but</span> <span class="nt">is</span> <span class="nt">known</span> <span class="nt">to</span> <span class="nt">break</span> <span class="nt">things</span> <span class="nt">on</span> <span class="nt">some</span> <span class="nt">drivers</span> <span class="o">(</span><span class="nt">LLVMpipe</span><span class="o">).</span>
<span class="err">#</span> <span class="nt">Recommended</span> <span class="nt">if</span> <span class="nt">it</span> <span class="nt">works</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">glx-no-rebind-pixmap</span> <span class="o">=</span> <span class="nt">true</span><span class="o">;</span>


<span class="err">#</span> <span class="nt">GLX</span> <span class="nt">backend</span><span class="o">:</span> <span class="nt">GLX</span> <span class="nt">buffer</span> <span class="nt">swap</span> <span class="nt">method</span> <span class="nt">we</span> <span class="nt">assume</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">Could</span> <span class="nt">be</span> <span class="nt">undefined</span> <span class="o">(</span><span class="nt">0</span><span class="o">),</span> <span class="nt">copy</span> <span class="o">(</span><span class="nt">1</span><span class="o">),</span> <span class="nt">exchange</span> <span class="o">(</span><span class="nt">2</span><span class="o">),</span> <span class="nt">3-6</span><span class="o">,</span> <span class="nt">or</span> <span class="nt">buffer-age</span> <span class="o">(</span><span class="nt">-1</span><span class="o">).</span>
<span class="err">#</span> <span class="nt">undefined</span> <span class="nt">is</span> <span class="nt">the</span> <span class="nt">slowest</span> <span class="nt">and</span> <span class="nt">the</span> <span class="nt">safest</span><span class="o">,</span> <span class="nt">and</span> <span class="nt">the</span> <span class="nt">default</span> <span class="nt">value</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">copy</span> <span class="nt">is</span> <span class="nt">fastest</span><span class="o">,</span> <span class="nt">but</span> <span class="nt">may</span> <span class="nt">fail</span> <span class="nt">on</span> <span class="nt">some</span> <span class="nt">drivers</span><span class="o">,</span>
<span class="err">#</span> <span class="nt">2-6</span> <span class="nt">are</span> <span class="nt">gradually</span> <span class="nt">slower</span> <span class="nt">but</span> <span class="nt">safer</span> <span class="o">(</span><span class="nt">6</span> <span class="nt">is</span> <span class="nt">still</span> <span class="nt">faster</span> <span class="nt">than</span> <span class="nt">0</span><span class="o">).</span>
<span class="err">#</span> <span class="nt">Usually</span><span class="o">,</span> <span class="nt">double</span> <span class="nt">buffer</span> <span class="nt">means</span> <span class="nt">2</span><span class="o">,</span> <span class="nt">triple</span> <span class="nt">buffer</span> <span class="nt">means</span> <span class="nt">3</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">buffer-age</span> <span class="nt">means</span> <span class="nt">auto-detect</span> <span class="nt">using</span> <span class="nt">GLX_EXT_buffer_age</span><span class="o">,</span> <span class="nt">supported</span> <span class="nt">by</span> <span class="nt">some</span> <span class="nt">drivers</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">Useless</span> <span class="nt">with</span> <span class="nt">--glx-use-copysubbuffermesa</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">Partially</span> <span class="nt">breaks</span> <span class="nt">--resize-damage</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">Defaults</span> <span class="nt">to</span> <span class="nt">undefined</span><span class="o">.</span>
<span class="nt">glx-swap-method</span> <span class="o">=</span> <span class="s2">&quot;undefined&quot;</span><span class="o">;</span>

<span class="err">#################################</span>
<span class="err">#</span>
<span class="err">#</span> <span class="nt">Shadows</span>
<span class="err">#</span>
<span class="err">#################################</span>

<span class="err">#</span> <span class="nt">Enabled</span> <span class="nt">client-side</span> <span class="nt">shadows</span> <span class="nt">on</span> <span class="nt">windows</span><span class="o">.</span>
<span class="nt">shadow</span> <span class="o">=</span> <span class="nt">true</span><span class="o">;</span>
<span class="err">#</span> <span class="nt">Don</span><span class="s1">&#39;t draw shadows on DND windows.</span>
<span class="s1">no-dnd-shadow = true;</span>
<span class="s1"># Avoid drawing shadows on dock/panel windows.</span>
<span class="s1">no-dock-shadow = true;</span>
<span class="s1"># Zero the part of the shadow&#39;</span><span class="nt">s</span> <span class="nt">mask</span> <span class="nt">behind</span> <span class="nt">the</span> <span class="nt">window</span><span class="o">.</span> <span class="nt">Fix</span> <span class="nt">some</span> <span class="nt">weirdness</span> <span class="nt">with</span> <span class="nt">ARGB</span> <span class="nt">windows</span><span class="o">.</span>
<span class="nt">clear-shadow</span> <span class="o">=</span> <span class="nt">true</span><span class="o">;</span>
<span class="err">#</span> <span class="nt">The</span> <span class="nt">blur</span> <span class="nt">radius</span> <span class="nt">for</span> <span class="nt">shadows</span><span class="o">.</span> <span class="o">(</span><span class="nt">default</span> <span class="nt">12</span><span class="o">)</span>
<span class="nt">shadow-radius</span> <span class="o">=</span> <span class="nt">5</span><span class="o">;</span>
<span class="err">#</span> <span class="nt">The</span> <span class="nt">left</span> <span class="nt">offset</span> <span class="nt">for</span> <span class="nt">shadows</span><span class="o">.</span> <span class="o">(</span><span class="nt">default</span> <span class="nt">-15</span><span class="o">)</span>
<span class="nt">shadow-offset-x</span> <span class="o">=</span> <span class="nt">-5</span><span class="o">;</span>
<span class="err">#</span> <span class="nt">The</span> <span class="nt">top</span> <span class="nt">offset</span> <span class="nt">for</span> <span class="nt">shadows</span><span class="o">.</span> <span class="o">(</span><span class="nt">default</span> <span class="nt">-15</span><span class="o">)</span>
<span class="nt">shadow-offset-y</span> <span class="o">=</span> <span class="nt">-5</span><span class="o">;</span>
<span class="err">#</span> <span class="nt">The</span> <span class="nt">translucency</span> <span class="nt">for</span> <span class="nt">shadows</span><span class="o">.</span> <span class="o">(</span><span class="nt">default</span> <span class="nc">.75</span><span class="o">)</span>
<span class="nt">shadow-opacity</span> <span class="o">=</span> <span class="nt">0</span><span class="nc">.5</span><span class="o">;</span>

<span class="err">#</span> <span class="nt">Set</span> <span class="nt">if</span> <span class="nt">you</span> <span class="nt">want</span> <span class="nt">different</span> <span class="nt">colour</span> <span class="nt">shadows</span>
<span class="err">#</span> <span class="nt">shadow-red</span> <span class="o">=</span> <span class="nt">0</span><span class="nc">.0</span><span class="o">;</span>
<span class="err">#</span> <span class="nt">shadow-green</span> <span class="o">=</span> <span class="nt">0</span><span class="nc">.0</span><span class="o">;</span>
<span class="err">#</span> <span class="nt">shadow-blue</span> <span class="o">=</span> <span class="nt">0</span><span class="nc">.0</span><span class="o">;</span>

<span class="err">#</span> <span class="nt">The</span> <span class="nt">shadow</span> <span class="nt">exclude</span> <span class="nt">options</span> <span class="nt">are</span> <span class="nt">helpful</span> <span class="nt">if</span> <span class="nt">you</span> <span class="nt">have</span> <span class="nt">shadows</span> <span class="nt">enabled</span><span class="o">.</span> <span class="nt">Due</span> <span class="nt">to</span> <span class="nt">the</span> <span class="nt">way</span> <span class="nt">compton</span> <span class="nt">draws</span> <span class="nt">its</span> <span class="nt">shadows</span><span class="o">,</span> <span class="nt">certain</span> <span class="nt">applications</span> <span class="nt">will</span> <span class="nt">have</span> <span class="nt">visual</span> <span class="nt">glitches</span>
<span class="err">#</span> <span class="o">(</span><span class="nt">most</span> <span class="nt">applications</span> <span class="nt">are</span> <span class="nt">fine</span><span class="o">,</span> <span class="nt">only</span> <span class="nt">apps</span> <span class="nt">that</span> <span class="nt">do</span> <span class="nt">weird</span> <span class="nt">things</span> <span class="nt">with</span> <span class="nt">xshapes</span> <span class="nt">or</span> <span class="nt">argb</span> <span class="nt">are</span> <span class="nt">affected</span><span class="o">).</span>
<span class="err">#</span> <span class="nt">This</span> <span class="nt">list</span> <span class="nt">includes</span> <span class="nt">all</span> <span class="nt">the</span> <span class="nt">affected</span> <span class="nt">apps</span> <span class="nt">I</span> <span class="nt">found</span> <span class="nt">in</span> <span class="nt">my</span> <span class="nt">testing</span><span class="o">.</span> <span class="nt">The</span> <span class="s2">&quot;! name~=&#39;&#39;&quot;</span> <span class="nt">part</span> <span class="nt">excludes</span> <span class="nt">shadows</span> <span class="nt">on</span> <span class="nt">any</span> <span class="s2">&quot;Unknown&quot;</span> <span class="nt">windows</span><span class="o">,</span> <span class="nt">this</span> <span class="nt">prevents</span> <span class="nt">a</span> <span class="nt">visual</span> <span class="nt">glitch</span> <span class="nt">with</span> <span class="nt">the</span> <span class="nt">XFWM</span> <span class="nt">alt</span> <span class="nt">tab</span> <span class="nt">switcher</span><span class="o">.</span>
<span class="nt">shadow-exclude</span> <span class="o">=</span> <span class="cp">[</span>
    <span class="s2">&quot;! name~=&#39;&#39;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name = &#39;Notification&#39;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name = &#39;Plank&#39;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name = &#39;Docky&#39;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name = &#39;Kupfer&#39;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name = &#39;xfce4-notifyd&#39;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name *= &#39;VLC&#39;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name *= &#39;compton&#39;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name *= &#39;Chromium&#39;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name *= &#39;Chrome&#39;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name *= &#39;Firefox&#39;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;class_g = &#39;Conky&#39;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;class_g = &#39;Kupfer&#39;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;class_g = &#39;Synapse&#39;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;class_g ?= &#39;Notify-osd&#39;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;class_g ?= &#39;Cairo-dock&#39;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;class_g ?= &#39;Xfce4-notifyd&#39;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;class_g ?= &#39;Xfce4-power-manager&#39;&quot;</span>
<span class="cp">]</span><span class="o">;</span>
<span class="err">#</span> <span class="nt">Avoid</span> <span class="nt">drawing</span> <span class="nt">shadow</span> <span class="nt">on</span> <span class="nt">all</span> <span class="nt">shaped</span> <span class="nt">windows</span> <span class="o">(</span><span class="nt">see</span> <span class="nt">also</span><span class="o">:</span> <span class="nt">--detect-rounded-corners</span><span class="o">)</span>
<span class="nt">shadow-ignore-shaped</span> <span class="o">=</span> <span class="nt">false</span><span class="o">;</span>

<span class="err">#################################</span>
<span class="err">#</span>
<span class="err">#</span> <span class="nt">Opacity</span>
<span class="err">#</span>
<span class="err">#################################</span>

<span class="nt">menu-opacity</span> <span class="o">=</span> <span class="nt">1</span><span class="o">;</span>
<span class="nt">inactive-opacity</span> <span class="o">=</span> <span class="nt">1</span><span class="o">;</span>
<span class="nt">active-opacity</span> <span class="o">=</span> <span class="nt">1</span><span class="o">;</span>
<span class="nt">frame-opacity</span> <span class="o">=</span> <span class="nt">1</span><span class="o">;</span>
<span class="nt">inactive-opacity-override</span> <span class="o">=</span> <span class="nt">false</span><span class="o">;</span>
<span class="nt">alpha-step</span> <span class="o">=</span> <span class="nt">0</span><span class="nc">.06</span><span class="o">;</span>

<span class="err">#</span> <span class="nt">Dim</span> <span class="nt">inactive</span> <span class="nt">windows</span><span class="o">.</span> <span class="o">(</span><span class="nt">0</span><span class="nc">.0</span> <span class="nt">-</span> <span class="nt">1</span><span class="nc">.0</span><span class="o">)</span>
<span class="err">#</span> <span class="nt">inactive-dim</span> <span class="o">=</span> <span class="nt">0</span><span class="nc">.2</span><span class="o">;</span>
<span class="err">#</span> <span class="nt">Do</span> <span class="nt">not</span> <span class="nt">let</span> <span class="nt">dimness</span> <span class="nt">adjust</span> <span class="nt">based</span> <span class="nt">on</span> <span class="nt">window</span> <span class="nt">opacity</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">inactive-dim-fixed</span> <span class="o">=</span> <span class="nt">true</span><span class="o">;</span>
<span class="err">#</span> <span class="nt">Blur</span> <span class="nt">background</span> <span class="nt">of</span> <span class="nt">transparent</span> <span class="nt">windows</span><span class="o">.</span> <span class="nt">Bad</span> <span class="nt">performance</span> <span class="nt">with</span> <span class="nt">X</span> <span class="nt">Render</span> <span class="nt">backend</span><span class="o">.</span> <span class="nt">GLX</span> <span class="nt">backend</span> <span class="nt">is</span> <span class="nt">preferred</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">blur-background</span> <span class="o">=</span> <span class="nt">true</span><span class="o">;</span>
<span class="err">#</span> <span class="nt">Blur</span> <span class="nt">background</span> <span class="nt">of</span> <span class="nt">opaque</span> <span class="nt">windows</span> <span class="nt">with</span> <span class="nt">transparent</span> <span class="nt">frames</span> <span class="nt">as</span> <span class="nt">well</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">blur-background-frame</span> <span class="o">=</span> <span class="nt">true</span><span class="o">;</span>
<span class="err">#</span> <span class="nt">Do</span> <span class="nt">not</span> <span class="nt">let</span> <span class="nt">blur</span> <span class="nt">radius</span> <span class="nt">adjust</span> <span class="nt">based</span> <span class="nt">on</span> <span class="nt">window</span> <span class="nt">opacity</span><span class="o">.</span>
<span class="nt">blur-background-fixed</span> <span class="o">=</span> <span class="nt">false</span><span class="o">;</span>
<span class="nt">blur-background-exclude</span> <span class="o">=</span> <span class="cp">[</span>
    <span class="s2">&quot;window_type = &#39;dock&#39;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;window_type = &#39;desktop&#39;&quot;</span>
<span class="cp">]</span><span class="o">;</span>

<span class="err">#################################</span>
<span class="err">#</span>
<span class="err">#</span> <span class="nt">Fading</span>
<span class="err">#</span>
<span class="err">#################################</span>

<span class="err">#</span> <span class="nt">Fade</span> <span class="nt">windows</span> <span class="nt">during</span> <span class="nt">opacity</span> <span class="nt">changes</span><span class="o">.</span>
<span class="nt">fading</span> <span class="o">=</span> <span class="nt">true</span><span class="o">;</span>
<span class="err">#</span> <span class="nt">The</span> <span class="nt">time</span> <span class="nt">between</span> <span class="nt">steps</span> <span class="nt">in</span> <span class="nt">a</span> <span class="nt">fade</span> <span class="nt">in</span> <span class="nt">milliseconds</span><span class="o">.</span> <span class="o">(</span><span class="nt">default</span> <span class="nt">10</span><span class="o">).</span>
<span class="nt">fade-delta</span> <span class="o">=</span> <span class="nt">4</span><span class="o">;</span>
<span class="err">#</span> <span class="nt">Opacity</span> <span class="nt">change</span> <span class="nt">between</span> <span class="nt">steps</span> <span class="nt">while</span> <span class="nt">fading</span> <span class="nt">in</span><span class="o">.</span> <span class="o">(</span><span class="nt">default</span> <span class="nt">0</span><span class="nc">.028</span><span class="o">).</span>
<span class="nt">fade-in-step</span> <span class="o">=</span> <span class="nt">0</span><span class="nc">.03</span><span class="o">;</span>
<span class="err">#</span> <span class="nt">Opacity</span> <span class="nt">change</span> <span class="nt">between</span> <span class="nt">steps</span> <span class="nt">while</span> <span class="nt">fading</span> <span class="nt">out</span><span class="o">.</span> <span class="o">(</span><span class="nt">default</span> <span class="nt">0</span><span class="nc">.03</span><span class="o">).</span>
<span class="nt">fade-out-step</span> <span class="o">=</span> <span class="nt">0</span><span class="nc">.03</span><span class="o">;</span>
<span class="err">#</span> <span class="nt">Fade</span> <span class="nt">windows</span> <span class="nt">in</span><span class="o">/</span><span class="nt">out</span> <span class="nt">when</span> <span class="nt">opening</span><span class="o">/</span><span class="nt">closing</span>
<span class="err">#</span> <span class="nt">no-fading-openclose</span> <span class="o">=</span> <span class="nt">true</span><span class="o">;</span>

<span class="err">#</span> <span class="nt">Specify</span> <span class="nt">a</span> <span class="nt">list</span> <span class="nt">of</span> <span class="nt">conditions</span> <span class="nt">of</span> <span class="nt">windows</span> <span class="nt">that</span> <span class="nt">should</span> <span class="nt">not</span> <span class="nt">be</span> <span class="nt">faded</span><span class="o">.</span>
<span class="nt">fade-exclude</span> <span class="o">=</span> <span class="cp">[</span> <span class="cp">]</span><span class="o">;</span>

<span class="err">#################################</span>
<span class="err">#</span>
<span class="err">#</span> <span class="nt">Other</span>
<span class="err">#</span>
<span class="err">#################################</span>

<span class="err">#</span> <span class="nt">Try</span> <span class="nt">to</span> <span class="nt">detect</span> <span class="nt">WM</span> <span class="nt">windows</span> <span class="nt">and</span> <span class="nt">mark</span> <span class="nt">them</span> <span class="nt">as</span> <span class="nt">active</span><span class="o">.</span>
<span class="nt">mark-wmwin-focused</span> <span class="o">=</span> <span class="nt">true</span><span class="o">;</span>
<span class="err">#</span> <span class="nt">Mark</span> <span class="nt">all</span> <span class="nt">non-WM</span> <span class="nt">but</span> <span class="nt">override-redirect</span> <span class="nt">windows</span> <span class="nt">active</span> <span class="o">(</span><span class="nt">e</span><span class="nc">.g</span><span class="o">.</span> <span class="nt">menus</span><span class="o">).</span>
<span class="nt">mark-ovredir-focused</span> <span class="o">=</span> <span class="nt">true</span><span class="o">;</span>
<span class="err">#</span> <span class="nt">Use</span> <span class="nt">EWMH</span> <span class="nt">_NET_WM_ACTIVE_WINDOW</span> <span class="nt">to</span> <span class="nt">determine</span> <span class="nt">which</span> <span class="nt">window</span> <span class="nt">is</span> <span class="nt">focused</span> <span class="nt">instead</span> <span class="nt">of</span> <span class="nt">using</span> <span class="nt">FocusIn</span><span class="o">/</span><span class="nt">Out</span> <span class="nt">events</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">Usually</span> <span class="nt">more</span> <span class="nt">reliable</span> <span class="nt">but</span> <span class="nt">depends</span> <span class="nt">on</span> <span class="nt">a</span> <span class="nt">EWMH-compliant</span> <span class="nt">WM</span><span class="o">.</span>
<span class="nt">use-ewmh-active-win</span> <span class="o">=</span> <span class="nt">true</span><span class="o">;</span>
<span class="err">#</span> <span class="nt">Detect</span> <span class="nt">rounded</span> <span class="nt">corners</span> <span class="nt">and</span> <span class="nt">treat</span> <span class="nt">them</span> <span class="nt">as</span> <span class="nt">rectangular</span> <span class="nt">when</span> <span class="nt">--shadow-ignore-shaped</span> <span class="nt">is</span> <span class="nt">on</span><span class="o">.</span>
<span class="nt">detect-rounded-corners</span> <span class="o">=</span> <span class="nt">true</span><span class="o">;</span>

<span class="err">#</span> <span class="nt">Detect</span> <span class="nt">_NET_WM_OPACITY</span> <span class="nt">on</span> <span class="nt">client</span> <span class="nt">windows</span><span class="o">,</span> <span class="nt">useful</span> <span class="nt">for</span> <span class="nt">window</span> <span class="nt">managers</span> <span class="nt">not</span> <span class="nt">passing</span> <span class="nt">_NET_WM_OPACITY</span> <span class="nt">of</span> <span class="nt">client</span> <span class="nt">windows</span> <span class="nt">to</span> <span class="nt">frame</span> <span class="nt">windows</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">This</span> <span class="nt">prevents</span> <span class="nt">opacity</span> <span class="nt">being</span> <span class="nt">ignored</span> <span class="nt">for</span> <span class="nt">some</span> <span class="nt">apps</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">For</span> <span class="nt">example</span> <span class="nt">without</span> <span class="nt">this</span> <span class="nt">enabled</span> <span class="nt">my</span> <span class="nt">xfce4-notifyd</span> <span class="nt">is</span> <span class="nt">100</span><span class="o">%</span> <span class="nt">opacity</span> <span class="nt">no</span> <span class="nt">matter</span> <span class="nt">what</span><span class="o">.</span>
<span class="nt">detect-client-opacity</span> <span class="o">=</span> <span class="nt">true</span><span class="o">;</span>

<span class="err">#</span> <span class="nt">Specify</span> <span class="nt">refresh</span> <span class="nt">rate</span> <span class="nt">of</span> <span class="nt">the</span> <span class="nt">screen</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">If</span> <span class="nt">not</span> <span class="nt">specified</span> <span class="nt">or</span> <span class="nt">0</span><span class="o">,</span> <span class="nt">compton</span> <span class="nt">will</span> <span class="nt">try</span> <span class="nt">detecting</span> <span class="nt">this</span> <span class="nt">with</span> <span class="nt">X</span> <span class="nt">RandR</span> <span class="nt">extension</span><span class="o">.</span>
<span class="nt">refresh-rate</span> <span class="o">=</span> <span class="nt">0</span><span class="o">;</span>

<span class="err">#</span> <span class="nt">Set</span> <span class="nt">VSync</span> <span class="nt">method</span><span class="o">.</span> <span class="nt">VSync</span> <span class="nt">methods</span> <span class="nt">currently</span> <span class="nt">available</span><span class="o">:</span>
<span class="err">#</span> <span class="nt">none</span><span class="o">:</span> <span class="nt">No</span> <span class="nt">VSync</span>
<span class="err">#</span> <span class="nt">drm</span><span class="o">:</span> <span class="nt">VSync</span> <span class="nt">with</span> <span class="nt">DRM_IOCTL_WAIT_VBLANK</span><span class="o">.</span> <span class="nt">May</span> <span class="nt">only</span> <span class="nt">work</span> <span class="nt">on</span> <span class="nt">some</span> <span class="nt">drivers</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">opengl</span><span class="o">:</span> <span class="nt">Try</span> <span class="nt">to</span> <span class="nt">VSync</span> <span class="nt">with</span> <span class="nt">SGI_video_sync</span> <span class="nt">OpenGL</span> <span class="nt">extension</span><span class="o">.</span> <span class="nt">Only</span> <span class="nt">work</span> <span class="nt">on</span> <span class="nt">some</span> <span class="nt">drivers</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">opengl-oml</span><span class="o">:</span> <span class="nt">Try</span> <span class="nt">to</span> <span class="nt">VSync</span> <span class="nt">with</span> <span class="nt">OML_sync_control</span> <span class="nt">OpenGL</span> <span class="nt">extension</span><span class="o">.</span> <span class="nt">Only</span> <span class="nt">work</span> <span class="nt">on</span> <span class="nt">some</span> <span class="nt">drivers</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">opengl-swc</span><span class="o">:</span> <span class="nt">Try</span> <span class="nt">to</span> <span class="nt">VSync</span> <span class="nt">with</span> <span class="nt">SGI_swap_control</span> <span class="nt">OpenGL</span> <span class="nt">extension</span><span class="o">.</span> <span class="nt">Only</span> <span class="nt">work</span> <span class="nt">on</span> <span class="nt">some</span> <span class="nt">drivers</span><span class="o">.</span> <span class="nt">Works</span> <span class="nt">only</span> <span class="nt">with</span> <span class="nt">GLX</span> <span class="nt">backend</span><span class="o">.</span> <span class="nt">Known</span> <span class="nt">to</span> <span class="nt">be</span> <span class="nt">most</span> <span class="nt">effective</span> <span class="nt">on</span> <span class="nt">many</span> <span class="nt">drivers</span><span class="o">.</span> <span class="nt">Does</span> <span class="nt">not</span> <span class="nt">actually</span> <span class="nt">control</span> <span class="nt">paint</span> <span class="nt">timing</span><span class="o">,</span> <span class="nt">only</span> <span class="nt">buffer</span> <span class="nt">swap</span> <span class="nt">is</span> <span class="nt">affected</span><span class="o">,</span> <span class="nt">so</span> <span class="nt">it</span> <span class="nt">doesn</span><span class="err">’</span><span class="nt">t</span> <span class="nt">have</span> <span class="nt">the</span> <span class="nt">effect</span> <span class="nt">of</span> <span class="nt">--sw-opti</span> <span class="nt">unlike</span> <span class="nt">other</span> <span class="nt">methods</span><span class="o">.</span> <span class="nt">Experimental</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">opengl-mswc</span><span class="o">:</span> <span class="nt">Try</span> <span class="nt">to</span> <span class="nt">VSync</span> <span class="nt">with</span> <span class="nt">MESA_swap_control</span> <span class="nt">OpenGL</span> <span class="nt">extension</span><span class="o">.</span> <span class="nt">Basically</span> <span class="nt">the</span> <span class="nt">same</span> <span class="nt">as</span> <span class="nt">opengl-swc</span> <span class="nt">above</span><span class="o">,</span> <span class="nt">except</span> <span class="nt">the</span> <span class="nt">extension</span> <span class="nt">we</span> <span class="nt">use</span><span class="o">.</span>
<span class="err">#</span> <span class="o">(</span><span class="nt">Note</span> <span class="nt">some</span> <span class="nt">VSync</span> <span class="nt">methods</span> <span class="nt">may</span> <span class="nt">not</span> <span class="nt">be</span> <span class="nt">enabled</span> <span class="nt">at</span> <span class="nt">compile</span> <span class="nt">time</span><span class="o">.)</span>
<span class="nt">vsync</span> <span class="o">=</span> <span class="s2">&quot;opengl-swc&quot;</span><span class="o">;</span>

<span class="err">#</span> <span class="nt">Enable</span> <span class="nt">DBE</span> <span class="nt">painting</span> <span class="nt">mode</span><span class="o">,</span> <span class="nt">intended</span> <span class="nt">to</span> <span class="nt">use</span> <span class="nt">with</span> <span class="nt">VSync</span> <span class="nt">to</span> <span class="o">(</span><span class="nt">hopefully</span><span class="o">)</span> <span class="nt">eliminate</span> <span class="nt">tearing</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">Reported</span> <span class="nt">to</span> <span class="nt">have</span> <span class="nt">no</span> <span class="nt">effect</span><span class="o">,</span> <span class="nt">though</span><span class="o">.</span>
<span class="nt">dbe</span> <span class="o">=</span> <span class="nt">false</span><span class="o">;</span>
<span class="err">#</span> <span class="nt">Painting</span> <span class="nt">on</span> <span class="nt">X</span> <span class="nt">Composite</span> <span class="nt">overlay</span> <span class="nt">window</span><span class="o">.</span> <span class="nt">Recommended</span><span class="o">.</span>
<span class="nt">paint-on-overlay</span> <span class="o">=</span> <span class="nt">true</span><span class="o">;</span>

<span class="err">#</span> <span class="nt">Limit</span> <span class="nt">compton</span> <span class="nt">to</span> <span class="nt">repaint</span> <span class="nt">at</span> <span class="nt">most</span> <span class="nt">once</span> <span class="nt">every</span> <span class="nt">1</span> <span class="o">/</span> <span class="nt">refresh_rate</span> <span class="nt">second</span> <span class="nt">to</span> <span class="nt">boost</span> <span class="nt">performance</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">This</span> <span class="nt">should</span> <span class="nt">not</span> <span class="nt">be</span> <span class="nt">used</span> <span class="nt">with</span> <span class="nt">--vsync</span> <span class="nt">drm</span><span class="o">/</span><span class="nt">opengl</span><span class="o">/</span><span class="nt">opengl-oml</span> <span class="nt">as</span> <span class="nt">they</span> <span class="nt">essentially</span> <span class="nt">does</span> <span class="nt">--sw-opti</span><span class="err">&#39;</span><span class="nt">s</span> <span class="nt">job</span> <span class="nt">already</span><span class="o">,</span>
<span class="err">#</span> <span class="nt">unless</span> <span class="nt">you</span> <span class="nt">wish</span> <span class="nt">to</span> <span class="nt">specify</span> <span class="nt">a</span> <span class="nt">lower</span> <span class="nt">refresh</span> <span class="nt">rate</span> <span class="nt">than</span> <span class="nt">the</span> <span class="nt">actual</span> <span class="nt">value</span><span class="o">.</span>
<span class="nt">sw-opti</span> <span class="o">=</span> <span class="nt">false</span><span class="o">;</span>

<span class="err">#</span> <span class="nt">Unredirect</span> <span class="nt">all</span> <span class="nt">windows</span> <span class="nt">if</span> <span class="nt">a</span> <span class="nt">full-screen</span> <span class="nt">opaque</span> <span class="nt">window</span> <span class="nt">is</span> <span class="nt">detected</span><span class="o">,</span> <span class="nt">to</span> <span class="nt">maximize</span> <span class="nt">performance</span> <span class="nt">for</span> <span class="nt">full-screen</span> <span class="nt">windows</span><span class="o">,</span> <span class="nt">like</span> <span class="nt">games</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">Known</span> <span class="nt">to</span> <span class="nt">cause</span> <span class="nt">flickering</span> <span class="nt">when</span> <span class="nt">redirecting</span><span class="o">/</span><span class="nt">unredirecting</span> <span class="nt">windows</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">paint-on-overlay</span> <span class="nt">may</span> <span class="nt">make</span> <span class="nt">the</span> <span class="nt">flickering</span> <span class="nt">less</span> <span class="nt">obvious</span><span class="o">.</span>
<span class="nt">unredir-if-possible</span> <span class="o">=</span> <span class="nt">true</span><span class="o">;</span>

<span class="err">#</span> <span class="nt">Specify</span> <span class="nt">a</span> <span class="nt">list</span> <span class="nt">of</span> <span class="nt">conditions</span> <span class="nt">of</span> <span class="nt">windows</span> <span class="nt">that</span> <span class="nt">should</span> <span class="nt">always</span> <span class="nt">be</span> <span class="nt">considered</span> <span class="nt">focused</span><span class="o">.</span>
<span class="nt">focus-exclude</span> <span class="o">=</span> <span class="cp">[</span> <span class="cp">]</span><span class="o">;</span>

<span class="err">#</span> <span class="nt">Use</span> <span class="nt">WM_TRANSIENT_FOR</span> <span class="nt">to</span> <span class="nt">group</span> <span class="nt">windows</span><span class="o">,</span> <span class="nt">and</span> <span class="nt">consider</span> <span class="nt">windows</span> <span class="nt">in</span> <span class="nt">the</span> <span class="nt">same</span> <span class="nt">group</span> <span class="nt">focused</span> <span class="nt">at</span> <span class="nt">the</span> <span class="nt">same</span> <span class="nt">time</span><span class="o">.</span>
<span class="nt">detect-transient</span> <span class="o">=</span> <span class="nt">true</span><span class="o">;</span>
<span class="err">#</span> <span class="nt">Use</span> <span class="nt">WM_CLIENT_LEADER</span> <span class="nt">to</span> <span class="nt">group</span> <span class="nt">windows</span><span class="o">,</span> <span class="nt">and</span> <span class="nt">consider</span> <span class="nt">windows</span> <span class="nt">in</span> <span class="nt">the</span> <span class="nt">same</span> <span class="nt">group</span> <span class="nt">focused</span> <span class="nt">at</span> <span class="nt">the</span> <span class="nt">same</span> <span class="nt">time</span><span class="o">.</span>
<span class="err">#</span> <span class="nt">WM_TRANSIENT_FOR</span> <span class="nt">has</span> <span class="nt">higher</span> <span class="nt">priority</span> <span class="nt">if</span> <span class="nt">--detect-transient</span> <span class="nt">is</span> <span class="nt">enabled</span><span class="o">,</span> <span class="nt">too</span><span class="o">.</span>
<span class="nt">detect-client-leader</span> <span class="o">=</span> <span class="nt">true</span><span class="o">;</span>

<span class="err">#################################</span>
<span class="err">#</span>
<span class="err">#</span> <span class="nt">Window</span> <span class="nt">type</span> <span class="nt">settings</span>
<span class="err">#</span>
<span class="err">#################################</span>

<span class="nt">wintypes</span><span class="o">:</span>
<span class="p">{</span>
    <span class="n">tooltip</span> <span class="o">=</span>
    <span class="err">{</span>
        <span class="err">#</span> <span class="n">fade</span><span class="o">:</span> <span class="n">Fade</span> <span class="n">the</span> <span class="n">particular</span> <span class="n">type</span> <span class="n">of</span> <span class="n">windows</span><span class="o">.</span>
        <span class="n">fade</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
        <span class="err">#</span> <span class="n">shadow</span><span class="o">:</span> <span class="n">Give</span> <span class="n">those</span> <span class="n">windows</span> <span class="n">shadow</span>
        <span class="n">shadow</span> <span class="o">=</span> <span class="n">false</span><span class="p">;</span>
        <span class="err">#</span> <span class="k">opacity</span><span class="o">:</span> <span class="n">Default</span> <span class="k">opacity</span> <span class="n">for</span> <span class="n">the</span> <span class="n">type</span> <span class="n">of</span> <span class="n">windows</span><span class="o">.</span>
        <span class="k">opacity</span> <span class="o">=</span> <span class="m">0</span><span class="o">.</span><span class="m">85</span><span class="p">;</span>
        <span class="err">#</span> <span class="n">focus</span><span class="o">:</span> <span class="n">Whether</span> <span class="n">to</span> <span class="k">always</span> <span class="n">consider</span> <span class="n">windows</span> <span class="n">of</span> <span class="n">this</span> <span class="n">type</span> <span class="n">focused</span><span class="o">.</span>
        <span class="n">focus</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
    <span class="p">}</span><span class="o">;</span>
<span class="err">}</span><span class="o">;</span>
</pre></div>


<p>In summary my full setup is the following:</p>
<ul>
<li>Ubuntu 14.04</li>
<li>nvidia-364 driver</li>
<li>xserver-xorg-video-modesetting (instead of intel's one)</li>
<li>compton window manager</li>
</ul>
<p>With that, I only experience minimal tearing, and no screen refresh issues.</p>
            
            <section>
<p id="comment-message">So what do you think? Did I miss something? Is any part
unclear? Leave your comments below. </p>
<div class="accordion" id="accordion2">
    <div class="accordion-group">
        <div class="accordion-heading">
            <a class="accordion-toggle disqus-comment-count" data-toggle="collapse" data-parent="#accordion2"
                href="http://arntanguy.github.io/blog/dealing-with-optimus-and-prime-issues-tearing-screen-refresh.html#disqus_thread">
                Comments
            </a>
        </div>
        <div id="disqus_thread" class="accordion-body collapse">
            <div class="accordion-inner">
                <div class="comments">
                    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'geenux';
        var disqus_identifier = 'http://arntanguy.github.io/blog/dealing-with-optimus-and-prime-issues-tearing-screen-refresh.html';
    var disqus_url = 'http://arntanguy.github.io/blog/dealing-with-optimus-and-prime-issues-tearing-screen-refresh.html';

    (function() {
         var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
         dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
         (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
     })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

                </div>
            </div>
        </div>
    </div>
</div>
</section>

            <hr/>
        </div>
        <section>
        <div class="span2" style="float:right;font-size:0.9em;">
            <h4>Published</h4>
            <time pubdate="pubdate" datetime="2016-06-20T00:00:00+02:00">Jun 20, 2016</time>
            <h4>Category</h4>
            <a class="category-link" href="http://arntanguy.github.io/blog/categories.html#linux-ref">Linux</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="http://arntanguy.github.io/blog/tags.html#linux-ref">linux
                    <span>7</span>
</a></li>
                <li><a href="http://arntanguy.github.io/blog/tags.html#nvidia-ref">nvidia
                    <span>1</span>
</a></li>
                <li><a href="http://arntanguy.github.io/blog/tags.html#prime-ref">prime
                    <span>1</span>
</a></li>
                <li><a href="http://arntanguy.github.io/blog/tags.html#ubuntu-ref">ubuntu
                    <span>2</span>
</a></li>
            </ul>
<h4>Contact</h4>
    <a href="http://www.linkedin.com/pub/arnaud-tanguy/34/a69/6a6" title="My LinkedIn Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-linkedin sidebar-social-links"></i></a>
    <a href="https://twitter.com/arntanguy" title="My Twitter Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-twitter sidebar-social-links"></i></a>
    <a href="https://github.com/geenux" title="My Github Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-github sidebar-social-links"></i></a>
    <a href="https://bitbucket.org/arn_tanguy" title="My Bitbucket Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-bitbucket sidebar-social-links"></i></a>
    <a href="https://plus.google.com/u/0/+ArnaudTanguy29" title="My Google+ Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-google+ sidebar-social-links"></i></a>
        </div>
        </section>
</div>
</article>
                </div>
                <div class="span1"></div>
            </div>
        </div>
        <div id="push"></div>
    </div>
<footer>
<div id="footer">
    <ul class="footer-content">
        <li class="elegant-license"><a rel="license"
href="http://creativecommons.org/licenses/by-sa/3.0/"><img
alt="Creative Commons License" style="border-width:0"
src="http://i.creativecommons.org/l/by-sa/3.0/80x15.png" /></a><br
/>This work is licensed under a <a rel="license"
href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons
Attribution-ShareAlike 3.0 Unported License</a>.</li>
        <li class="elegant-power">Powered by <a href="http://getpelican.com/" title="Pelican Home Page">Pelican</a>. Theme: <a href="http://oncrashreboot.com/pelican-elegant" title="Theme Elegant Home Page">Elegant</a> by <a href="http://oncrashreboot.com" title="Talha Mansoor Home Page">Talha Mansoor</a></li>
    </ul>
</div>
</footer>            <script src="http://code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

            <script type="text/javascript">
var disqus_shortname = 'geenux';
(function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>
<script  language="javascript" type="text/javascript">
function uncollapse() {
    if (window.location.hash.match(/^#comment-\d+$/)) {
        $('#disqus_thread').collapse('show');
    }
}
</script>
<script type="text/javascript" language="JavaScript">
uncollapse();
window.onhashchange=function(){
    if (window.location.hash.match(/^#comment-\d+$/))
        window.location.reload(true);
}
</script>
<script>
$('#disqus_thread').on('shown', function () {
    var link = document.getElementsByClassName('accordion-toggle');
    var old_innerHTML = link[0].innerHTML;
    $(link[0]).fadeOut(500, function() {
        $(this).text('Click here to hide comments').fadeIn(500);
    });
    $('#disqus_thread').on('hidden', function () {
        $(link[0]).fadeOut(500, function() {
            $(this).text(old_innerHTML).fadeIn(500);
        });
    })
})
</script>


    </body>
    <!-- Theme: Elegant built for Pelican
    License : http://oncrashreboot.com/pelican-elegant -->
</html>